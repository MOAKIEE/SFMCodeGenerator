<UserControl x:Class="SFMCodeGenerator.Views.WizardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:SFMCodeGenerator.ViewModels"
             Background="{StaticResource BackgroundBrush}">
    
    <UserControl.DataContext>
        <vm:WizardViewModel/>
    </UserControl.DataContext>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- æ‰§è¡Œé¢‘çŽ‡ -->
        <GroupBox Grid.Row="0" Header="â¶ æ‰§è¡Œé¢‘çŽ‡" Style="{StaticResource SettingsGroupBox}" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="æ¯éš”" Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                <TextBox Text="{Binding TickInterval, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource DefaultTextBox}" Width="60" Margin="8,0"/>
                <TextBlock Text="tick æ‰§è¡Œä¸€æ¬¡" Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
            </StackPanel>
        </GroupBox>
        
        <!-- ä»Žå“ªé‡Œæ‹¿ -->
        <GroupBox Grid.Row="1" Header="â· ä»Žå“ªé‡Œæ‹¿ï¼Ÿ" Style="{StaticResource SettingsGroupBox}" Margin="0,0,0,8">
            <StackPanel>
                <ItemsControl ItemsSource="{Binding Sources}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{StaticResource BackgroundLightBrush}" 
                                    CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- ç¬¬ä¸€è¡Œ -->
                                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="æ ‡ç­¾:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <TextBox Text="{Binding Label, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource DefaultTextBox}" Width="60" Margin="0,0,16,0"/>
                                        
                                        <TextBlock Text="æ–¹å‘:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <ComboBox ItemsSource="{Binding DataContext.SideOptions, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedItem="{Binding Side}" 
                                                  Style="{StaticResource DefaultComboBox}" Width="70" Margin="0,0,16,0"/>
                                        
                                        <TextBlock Text="æ•°é‡:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <TextBox Text="{Binding Quantity, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource DefaultTextBox}" Width="60"
                                                 ToolTip="ç•™ç©ºè¡¨ç¤ºå…¨éƒ¨"/>
                                    </StackPanel>
                                    
                                    <!-- ç¬¬äºŒè¡Œ -->
                                    <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal">
                                        <TextBlock Text="ç±»åž‹:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <ComboBox ItemsSource="{Binding DataContext.TypeOptions, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedItem="{Binding ResourceType}" 
                                                  Style="{StaticResource DefaultComboBox}" Width="70" Margin="0,0,16,0"/>
                                        
                                        <TextBlock Text="èµ„æºID:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="55"/>
                                        <TextBox Text="{Binding ResourceId, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource DefaultTextBox}" Width="150"
                                                 ToolTip="å¯é€‰ï¼Œå¦‚ minecraft:iron_ingot"/>
                                    </StackPanel>
                                    
                                    <!-- åˆ é™¤æŒ‰é’® -->
                                    <Button Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" Content="âœ•" 
                                            Style="{StaticResource SecondaryButton}" Width="30" Height="30"
                                            Command="{Binding DataContext.RemoveSourceCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                <Button Content="+ æ·»åŠ æ›´å¤šæ¥æº" Style="{StaticResource SecondaryButton}" 
                        Command="{Binding AddSourceCommand}" HorizontalAlignment="Left"/>
            </StackPanel>
        </GroupBox>
        
        <!-- æ”¾åˆ°å“ªé‡Œ -->
        <GroupBox Grid.Row="2" Header="â¸ æ”¾åˆ°å“ªé‡Œï¼Ÿ" Style="{StaticResource SettingsGroupBox}" Margin="0,0,0,8">
            <StackPanel>
                <ItemsControl ItemsSource="{Binding Targets}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{StaticResource BackgroundLightBrush}" 
                                    CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- ç¬¬ä¸€è¡Œ -->
                                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="æ ‡ç­¾:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <TextBox Text="{Binding Label, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource DefaultTextBox}" Width="60" Margin="0,0,16,0"/>
                                        
                                        <TextBlock Text="æ–¹å‘:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <ComboBox ItemsSource="{Binding DataContext.SideOptions, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedItem="{Binding Side}" 
                                                  Style="{StaticResource DefaultComboBox}" Width="70" Margin="0,0,16,0"/>
                                        
                                        <TextBlock Text="æ•°é‡:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <TextBox Text="{Binding Quantity, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource DefaultTextBox}" Width="60"
                                                 ToolTip="ç•™ç©ºè¡¨ç¤ºå…¨éƒ¨"/>
                                    </StackPanel>
                                    
                                    <!-- ç¬¬äºŒè¡Œ -->
                                    <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal">
                                        <TextBlock Text="ç±»åž‹:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="40"/>
                                        <ComboBox ItemsSource="{Binding DataContext.TypeOptions, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedItem="{Binding ResourceType}" 
                                                  Style="{StaticResource DefaultComboBox}" Width="70" Margin="0,0,16,0"/>
                                        
                                        <TextBlock Text="èµ„æºID:" Foreground="{StaticResource TextSecondaryBrush}" 
                                                   VerticalAlignment="Center" Width="55"/>
                                        <TextBox Text="{Binding ResourceId, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource DefaultTextBox}" Width="150"
                                                 ToolTip="å¯é€‰ï¼Œå¦‚ minecraft:iron_ingot"/>
                                    </StackPanel>
                                    
                                    <!-- åˆ é™¤æŒ‰é’® -->
                                    <Button Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" Content="âœ•" 
                                            Style="{StaticResource SecondaryButton}" Width="30" Height="30"
                                            Command="{Binding DataContext.RemoveTargetCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                <Button Content="+ æ·»åŠ æ›´å¤šç›®æ ‡" Style="{StaticResource SecondaryButton}" 
                        Command="{Binding AddTargetCommand}" HorizontalAlignment="Left"/>
            </StackPanel>
        </GroupBox>
        
        <!-- ä»£ç é¢„è§ˆ -->
        <GroupBox Grid.Row="3" Header="ðŸ“‹ ç”Ÿæˆçš„ä»£ç " Style="{StaticResource SettingsGroupBox}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBox Grid.Row="0" Text="{Binding GeneratedCode, Mode=OneWay}" 
                         Style="{StaticResource CodeTextBox}" IsReadOnly="True"
                         VerticalScrollBarVisibility="Auto"/>
                
                <Button Grid.Row="1" Content="ðŸ“‹ å¤åˆ¶ä»£ç " Style="{StaticResource PrimaryButton}"
                        Command="{Binding CopyCodeCommand}" HorizontalAlignment="Right" Margin="0,8,0,0"/>
            </Grid>
        </GroupBox>
    </Grid>
</UserControl>
